{
    // ═══════════════════════════════════════════════════════════════════════
    // DEVELOPMENT CONTAINER CONFIGURATION
    // ═══════════════════════════════════════════════════════════════════════
    // Three-layer Python architecture:
    //   1. System Python (/usr/local/bin/python) - For VS Code extensions
    //   2. Nix tools (flake.nix) - Development tools (uv, git, libraries)
    //   3. App Python (apps/*/.venv) - Per-app dependencies via uv
    // ═══════════════════════════════════════════════════════════════════════

    "name": "2026 Multi-Agent Lab",
    "image": "mcr.microsoft.com/devcontainers/python:3.12-bookworm",

    // ───────────────────────────────────────────────────────────────────────
    // FEATURES: Nix for tools, SSH for remote connection
    // ───────────────────────────────────────────────────────────────────────
    "features": {
        "ghcr.io/devcontainers/features/nix:1": {
            "version": "latest",
            "multiUser": false
        },
        "ghcr.io/devcontainers/features/sshd:1": {
            "version": "latest"
        }
    },

    // ───────────────────────────────────────────────────────────────────────
    // IDE: Extensions and settings
    // ───────────────────────────────────────────────────────────────────────
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "tamasfe.even-better-toml",
                "jnoortheen.nix-ide",
                "christian-kohler.path-intellisense"
            ],
            "settings": {
                // System Python for IDE (apps override with .venv in their own settings)
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "editor.formatOnSave": true,
                "python.terminal.activateEnvironment": false  // uv handles activation
            }
        }
    },

    // ───────────────────────────────────────────────────────────────────────
    // SETUP: Activate Nix environment on container creation
    // ───────────────────────────────────────────────────────────────────────
    "postCreateCommand": "nix develop",

    "remoteUser": "vscode"
}